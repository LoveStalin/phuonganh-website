<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Gửi Phương Anh</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
      background-color: #fff0f5;
    }
    .container {
      display: flex;
      align-items: flex-end;
      gap: 20px;
      position: relative;
      flex-wrap: wrap;
    }
    .letter {
      background-color: #ffffff;
      padding: 30px;
      border: 2px solid #ffaec9;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      max-width: 400px;
      font-size: 18px;
      line-height: 1.6;
      position: relative;
      z-index: 1;
    }
    img {
      max-height: 400px;
      border-radius: 10px;
      display: block;
    }
    .heart {
      position: absolute;
      font-size: 24px;
      animation: float 3s infinite ease-in-out;
    }
    .heart:nth-child(1) { top: -10px; left: -20px; animation-delay: 0s; }
    .heart:nth-child(2) { top: 20px; right: -30px; animation-delay: 0.5s; }
    .heart:nth-child(3) { bottom: -10px; left: 10px; animation-delay: 1s; }
    .heart:nth-child(4) { bottom: -20px; right: 20px; animation-delay: 1.5s; }

    @keyframes float {
      0% { transform: translateY(0); opacity: 1; }
      50% { transform: translateY(-10px); opacity: 0.7; }
      100% { transform: translateY(0); opacity: 1; }
    }

    .music-toggle {
      margin-top: 20px;
      padding: 8px 20px;
      background-color: #ffaec9;
      color: white;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 16px;
    }

    .audio-section {
      text-align: center;
      margin-top: 20px;
    }

    .audio-section audio {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background-color: #ffaec9;
    }

    .audio-section p {
      font-weight: bold;
      margin-top: 8px;
    }

    /* Media query */
    @media (max-width: 768px) {
      .container {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        align-items: flex-end;
        gap: 10px;
      }
      .letter, img { max-width: 90%; }
      img { max-height: 300px; margin-top: 0; }
      audio { width: 80px; height: 80px; border-radius: 50%; }
      p { font-size: 16px; }
    }

    /* Popup styles */
    .popup-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(255,192,203,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .popup-content {
      background: white;
      padding: 30px 40px;
      border-radius: 20px;
      text-align: center;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
      position: relative;
    }

    .popup-content button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #ff69b4;
      color: white;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 16px;
    }

    .heart-floating {
      position: absolute;
      font-size: 24px;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      animation: floatHeart 3s infinite ease-in-out;
    }

    @keyframes floatHeart {
      0% { transform: translateX(-50%) translateY(0); opacity: 1; }
      50% { transform: translateX(-50%) translateY(-15px); opacity: 0.7; }
      100% { transform: translateX(-50%) translateY(0); opacity: 1; }
    }

    .fade-out { animation: fadeOut 0.6s forwards; }
    .fade-in { animation: fadeIn 0.6s forwards; }

    @keyframes fadeOut {
      0% { opacity: 1; transform: scale(1); }
      100% { opacity: 0; transform: scale(0.95); }
    }

    @keyframes fadeIn {
      0% { opacity: 0; transform: scale(1.05); }
      100% { opacity: 1; transform: scale(1); }
    }
  </style>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LGJH4TYT65"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LGJH4TYT65');
</script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P579482N');</script>
<!-- End Google Tag Manager -->
</head>
<body>

<div class="container">
  <div class="heart">❤️</div>
  <div class="heart">💕</div>
  <div class="heart">💖</div>
  <div class="heart">💘</div>

  <div class="letter">
    <h2>Gửi Phương Anh</h2>
    <p>
      Có một người luôn ở trong tim tớ.
      Cậu là Phương Anh – người đã khiến tớ trưởng thành hơn từng ngày.
      Dù tương lai có ra sao, tớ vẫn luôn biết ơn vì tất cả.
      Vì cậu mà tớ đã học được rất nhiều điều.
      Phương Anh à! Tớ yêu cậu rất nhiều!
      Dù sao thì, chúc cậu một ngày sinh nhật đáng nhớ nhé!
      Tớ chúc cậu luôn học giỏi và thành công trong tương lai.
      Xuân Thành tớ đây sẽ luôn yêu thương và bảo vệ cậu.
      Vì cậu - tớ nguyện làm tất cả.💕💕💕(❁´◡`❁)
    </p>
  </div>
<!-- Lời mời đặc biệt -->
<div id="special-invite" onclick="showInvitePopup()" style="cursor: pointer; text-align: center; margin-top: 30px;">
  <div style="font-size: 50px;">🎟️</div>
  <div style="font-size: 20px; color: #e75480; font-weight: bold;">Lời mời đặc biệt!</div>
</div>

<!-- Popup -->
<div id="invite-popup" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; justify-content:center; align-items:center;">
  <div style="background:#fff0f5; padding:30px; border-radius:20px; max-width:90%; width:400px; text-align:center; box-shadow:0 4px 12px rgba(0,0,0,0.2);">
    <h2 style="color:#d6336c;">🎬 Lời mời Đặc Biệt!</h2>
    <p style="margin-top: 10px; font-size: 16px;">
      Phương Anh à!<br>Tớ muốn mời cậu đi xem phim với tớ...<br><br>
      Bộ phim và thời gian xem phim(sau ngày 09/07) thì sẽ phụ thuộc vào sự lựa chọn của cậu nha~~~<br>
      Còn tớ thì sẽ lo chuyện tiền nong và vé xem phim và các khoản tiền phụ!<br><br>
      Nếu cậu đồng ý, hãy gửi lời nhắn nhủ ở website này nha!<br>
      Nếu cậu từ chối, cậu có thể gửi lời lên website này, hoặc không gửi nếu cậu ngại.<br><br>
      <strong>09/07</strong> tớ sẽ lên web kiểm tra để xem câu trả lời của cậu ạ!<br>
      Cảm ơn cậu rất nhiều!
    </p>
    <button onclick="closeInvitePopup()" style="margin-top:20px; padding:10px 20px; background:#ff69b4; color:white; border:none; border-radius:8px; cursor:pointer;">OK 🥺</button>
  </div>
</div>

  <img src="phuonganhdangyeu.png" alt="Phương Anh chỉ tay">
</div>

<button class="music-toggle" onclick="toggleMusic()">🔊 Bật nhạc</button>

<audio id="bg-music" autoplay loop>
  <source src="audio/Doubt.mp3" type="audio/mp3">
</audio>

<div class="audio-section">
  <audio controls>
    <source src="audio/ghiamdanhchoPa.mp3" type="audio/mp3">
  </audio>
  <p>Nghe đi chị yêu,audio số 1 nhaa 😘</p>
</div>

<!-- Popup trang 1 -->
<div id="popup" class="popup-overlay">
  <div class="popup-content" id="popup-page-1">
    <h2>🎉 Chào Mừng Phương Anh 🎉</h2>
    <p>Xuân Thành đây!<br>Chúc cậu có ngày sinh nhật thật hạnh phúc và đáng nhớ nha 💖<br>
      Tớ đã dành cả ngày lẫn  chỉ để làm trang web nhỏ này cho cậu đó nha hihi<br>
      Không phải vì tớ rảnh đâu, mà là vì…<br>
      Tớ muốn làm ra một thứ gì đó chỉ dành riêng cho Phương Anh thôi (｡♥‿♥｡)<br>
      Và tớ cũng mong cậu hiểu rằng...<br>
      Tớ yêu thương cậu đến nhường nào,cũng như chuyện...Phương Anh đặc biết đến nhường nào💕💕</p>
    <button onclick="showNextPopupPage()">Tiếp ➤</button>
    <div class="heart-floating">❤️</div>
  </div>
</div>

<!-- Popup trang 2 -->
<div id="popup2" class="popup-overlay">
  <div class="popup-content fade-in">
    <h3>Trang Web này chỉ dành riêng cho cậu thôii 💝</h3>
    <p>
      Trang Web này bao gồm lời mà tớ muốn nói với cậu,<br>
      có nhạc Doubt (tớ không biết nên dùng nhạc nào 😁)<br>
      và một đoạn ghi âm 3p của tớ dành cho cậu.<br>
      Tớ chỉ có thể làm được như thế này trong 2 ngày thui, cậu thông cảm nha 😭🙏
    </p>
    <button onclick="acceptLove()">Ogeeee 🥺</button>
    <button onclick="declineLove()">Không 😏</button>
    <div class="heart-floating">💖</div>
  </div>
</div>

<!-- Cảm ơn -->
<div id="thankyou" class="popup-overlay">
  <div class="popup-content fade-in">
    <h2>Tớ cảm ơn cậu nhiều nhóoo 🥰</h2>
    <div class="heart-floating">💘</div>
  </div>
</div>

<!-- Xin lỗi -->
<div id="sorry" class="popup-overlay">
  <div class="popup-content fade-in">
    <h2>Cho tớ xin lỗi cậu nhiều ạ 😔</h2>
    <div class="heart-floating">💔</div>
  </div>
</div>
<!-- 👇 Thêm đoạn này vào cuối <body>, trước </body> -->
<script>
// Mưa tim
const numHearts = 50;
for (let i = 0; i < numHearts; i++) {
  const heart = document.createElement("div");
  heart.className = "rain-heart";
  heart.innerText = "💖";
  heart.style.left = Math.random() * 100 + "vw";
  heart.style.animationDuration = 2 + Math.random() * 3 + "s";
  heart.style.fontSize = 12 + Math.random() * 24 + "px";
  heart.style.top = Math.random() * -100 + "px";
  document.body.appendChild(heart);
}

// Gõ từng chữ
const letter = document.querySelector(".letter p");
const fullText = letter.innerHTML;
letter.innerHTML = ""; // Xóa để bắt đầu gõ
let i = 0;
function typeLetter() {
  if (i < fullText.length) {
    letter.innerHTML += fullText.charAt(i);
    i++;
    setTimeout(typeLetter, 40); // tốc độ gõ (ms)
  }
}
window.addEventListener("load", typeLetter);
</script>

<style>
/* 💖 CSS cho mưa tim */
.rain-heart {
  position: fixed;
  top: 0;
  z-index: 0;
  animation-name: dropHeart;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
}

@keyframes dropHeart {
  0% {
    transform: translateY(0);
    opacity: 1;
  }
  100% {
    transform: translateY(100vh);
    opacity: 0;
  }
}
</style>
<script>
  const bgMusic = document.getElementById("bg-music");
  const toggleBtn = document.querySelector(".music-toggle");

  function toggleMusic() {
    if (bgMusic.paused) {
      bgMusic.play();
      toggleBtn.innerText = "🔈 Tắt nhạc";
    } else {
      bgMusic.pause();
      toggleBtn.innerText = "🔊 Bật nhạc";
    }
  }

  // Khi trang load, hiện popup đầu
  window.onload = function() {
    document.getElementById("popup").style.display = "flex";
  };

  function showNextPopupPage() {
    const popup1 = document.getElementById("popup");
    popup1.classList.add("fade-out");
    setTimeout(() => {
      popup1.style.display = "none";
      document.getElementById("popup2").style.display = "flex";
    }, 600);
  }

  function acceptLove() {
    document.getElementById("popup2").style.display = "none";
    const thank = document.getElementById("thankyou");
    thank.style.display = "flex";
    setTimeout(() => { thank.style.display = "none"; }, 3000);
  }

  function declineLove() {
    document.getElementById("popup2").style.display = "none";
    document.getElementById("sorry").style.display = "flex";
  }
  // Mở popup 1 khi trang load
window.onload = function () {
  document.getElementById("popup").style.display = "flex";
};

function closePopup() {
  document.getElementById("popup").style.display = "none";
  document.getElementById("popup2").style.display = "flex"; // mở trang tiếp
}

function acceptLove() {
  document.getElementById("popup2").style.display = "none";
  document.getElementById("thankyou").style.display = "flex";

  // Tự động tắt sau 2 giây
  setTimeout(() => {
    document.getElementById("thankyou").style.display = "none";
  }, 2000);
}

function declineLove() {
  document.getElementById("popup2").style.display = "none";
  const sorry = document.getElementById("sorry");
  sorry.style.display = "flex";

  // Tự động tắt sau 2 giây
  setTimeout(() => {
    sorry.style.display = "none";
  }, 2000);
}
function postComment() {
  const name = document.getElementById("comment-name").value.trim() || "Ẩn danh";
  const message = document.getElementById("comment-message").value.trim();

  if (!message) {
    alert("Bạn chưa nhập lời nhắn!");
    return;
  }

  fetch("https://comment-cho-pa.onrender.com/comments", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({ name, message })
  })
    .then(response => {
      if (!response.ok) throw new Error("Gửi thất bại");
      return response.json();
    })
    .then(() => {
      document.getElementById("comment-name").value = "";
      document.getElementById("comment-message").value = "";
      renderComments();
    })
    .catch(error => {
      alert("Lỗi khi gửi lời nhắn 😭: " + error.message);
    });
}

function renderComments() {
  const list = document.getElementById("comment-list");
  list.innerHTML = "<p>Đang tải lời nhắn...</p>";

  fetch("https://comment-cho-pa.onrender.com/comments")
    .then(res => res.json())
    .then(comments => {
      list.innerHTML = "";
      comments.forEach((comment, index) => {
        const commentBox = document.createElement("div");
        commentBox.style.background = "#fff0f5";
        commentBox.style.border = "1px solid #ffaec9";
        commentBox.style.padding = "15px";
        commentBox.style.marginBottom = "10px";
        commentBox.style.borderRadius = "12px";
        commentBox.style.boxShadow = "0 2px 5px rgba(0,0,0,0.1)";

        // Hiện replies (nếu có)
        let repliesHTML = "";
        if (comment.replies && comment.replies.length > 0) {
          repliesHTML = `<div style="margin-top:10px; padding-left:20px;">`;
          comment.replies.forEach(reply => {
            repliesHTML += `
              <div style="margin-bottom:5px;">
                <strong style="color:#e75480;">↳ ${reply.name}</strong>: ${reply.message}
              </div>`;
          });
          repliesHTML += `</div>`;
        }

        // HTML hiển thị comment + form trả lời
        commentBox.innerHTML = `
          <div style="color: #e75480; font-weight: bold;">${comment.name}</div>
          <div style="margin-top: 5px;">${comment.message}</div>
          ${repliesHTML}
          <button onclick="showReplyBox(${index})" style="margin-top:10px;">💬 Trả lời</button>
          <div id="reply-box-${index}" style="display:none; margin-top:10px;">
            <input type="text" id="reply-name-${index}" placeholder="Tên bạn (nếu muốn)" />
            <input type="text" id="reply-message-${index}" placeholder="Nhập lời phản hồi" />
            <button onclick="sendReply(${index})">Gửi</button>
          </div>
        `;
        list.appendChild(commentBox);
      });
    })
    .catch(err => {
      list.innerHTML = "<p>Không thể tải lời nhắn 😢</p>";
      console.error(err);
    });
}
function showReplyBox(index) {
  const box = document.getElementById(`reply-box-${index}`);
  if (box.style.display === "none") {
    box.style.display = "block";
  } else {
    box.style.display = "none";
  }
}
function sendReply(index) {
  const name = document.getElementById(`reply-name-${index}`).value.trim() || "Ẩn danh";
  const message = document.getElementById(`reply-message-${index}`).value.trim();

  if (!message) {
    alert("Bạn chưa nhập lời phản hồi!");
    return;
  }

  fetch(`https://comment-cho-pa.onrender.com/comments/${index}/reply`, {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({ name, message })
  })
    .then(res => {
      if (!res.ok) throw new Error("Không gửi được phản hồi");
      return res.json();
    })
    .then(() => {
      // Clear input + ẩn form
      document.getElementById(`reply-name-${index}`).value = "";
      document.getElementById(`reply-message-${index}`).value = "";
      showReplyBox(index); // ẩn lại
      renderComments(); // load lại comment để hiện phản hồi
    })
    .catch(err => {
      alert("Gửi phản hồi thất bại 😭: " + err.message);
    });
}
// Gọi khi load trang
window.onload = function () {
  renderComments();
  window.scrollTo({ top: document.getElementById("comment-list").offsetTop, behavior: "smooth" });
  document.getElementById("popup").style.display = "flex";
};
const formattedMessage = message.replace(/\n/g, "<br>");
commentBox.innerHTML = `<strong>${name}</strong><br>${formattedMessage}`;
</script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P579482N"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
 <!-- Comment section -->
<div id="comment-section" style="margin-top: 50px; width: 100%; max-width: 600px; text-align: center;">
  <h3>💬 Viết lời nhắn mà Phương Anh gửi tới Xuân Thành 💬</h3>
  <input type="text" id="comment-name" placeholder="Tên bạn (hoặc để trống nếu ẩn danh)"
         style="padding: 10px; width: 80%; margin-bottom: 10px; border-radius: 10px; border: 1px solid #ffaec9;"><br>
  <textarea id="comment-message" rows="4" placeholder="Viết lời nhắn tại đây..."
            style="padding: 10px; width: 80%; border-radius: 10px; border: 1px solid #ffaec9;"></textarea><br>
  <button onclick="postComment()" 
          style="margin-top: 10px; padding: 10px 20px; background-color: #ff69b4; color: white; border: none; border-radius: 20px; cursor: pointer;">
    Gửi 💌
  </button>

  <div id="comment-list" style="margin-top: 30px; text-align: left;"></div>
</div>
<!-- PHẦN 1: THỜI GIAN TÌNH CẢM (Đếm ngày đã thích Phương Anh) -->
<div id="love-timer" style="position: fixed; bottom: 20px; left: 20px; background: #ffe4ec; padding: 12px 20px; border-radius: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); font-family: 'Segoe UI', sans-serif; font-weight: bold; color: #d63384; font-size: 16px;">
  <span id="day-counter">...</span>
</div>
<script>
  const firstLoveDate = new Date("2024-06-04"); // NGÀY BẮT ĐẦU THÍCH
  const today = new Date();
  const daysPassed = Math.floor((today - firstLoveDate) / (1000 * 60 * 60 * 24));
  document.getElementById("day-counter").innerText = `Đã ${daysPassed} ngày kể từ lúc tớ công khai thích cậu... 😍`;
</script>

  <!-- Nút nghe audio tâm sự -->
<div style="position: fixed; bottom: 15px; right: 15px; z-index: 1000;">
  <button onclick="toggleAudio()" style="padding: 10px 20px; background: #ffccdd; border: none; border-radius: 10px;">🎧 Nghe tâm sự</button>
</div>

<audio id="confession-audio" src="audio/ghiam2danhchoPa.mp3"></audio>

<script>
  let isPlaying = false;

  function toggleAudio() {
    const audio = document.getElementById("confession-audio");
    if (isPlaying) {
      audio.pause();
    } else {
      audio.play();
    }
    isPlaying = !isPlaying;
  }
</script>
</div>
<script>
  function showInvitePopup() {
    document.getElementById("invite-popup").style.display = "flex";
  }

  function closeInvitePopup() {
    document.getElementById("invite-popup").style.display = "none";
  }
</script>
</body>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
</html>